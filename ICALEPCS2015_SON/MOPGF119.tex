\documentclass[a4paper,
               %boxit,
               %titlepage,   % separate title page
               %refpage      % separate references
              ]{jacow}

\makeatletter%                           % test for XeTeX where the sequence is by default eps-> pdf, jpg, png, pdf, ...
\ifboolexpr{bool{xetex}}                 % and the JACoW template provides JACpic2v3.eps and JACpic2v3.jpg which might generates errors
 {\rJACoW2014A4.texenewcommand{\Gin@extensions}{.pdf,%
                    .png,.jpg,.bmp,.pict,.tif,.psd,.mac,.sga,.tga,.gif,%
                    .eps,.ps,%
                    }}{}
\makeatother

\ifboolexpr{bool{xetex} or bool{luatex}} % test for XeTeX/LuaTeX
 {}                                      % input enJACoW2014A4.texcoding is utf8 by default
 {\usepackage[utf8]{inputenc}}           % switch to utf8
 

\usepackage[USenglish]{babel}


\ifboolexpr{bool{jacowbiblatex}}%        % if BibLaTeX is used
 {%
  \addbibresource{jacow-test.bib}
  \addbibresource{biblatex-examples.bib}
 }{}

\newcommand\SEC[1]{\textbf{\uppercase{#1}}}
 
%%
%%   Lengths for the spaces in the title
%%   \setlength\titleblockstartskip{..}  %before title, default 3pt
%%   \setlength\titleblockmiddleskip{..} %between title + author, default 1em
%%   \setlength\titleblockendskip{..}    %afterauthor, de fault 1em

%\copyrightspace %default 1cm. arbitrary size with e.g. \copyrightspace[2cm]

% testing to fill the copyright space
%\usepackage{eso-pic}
%\AddToShipoutPictureFG*{\AtTextLowerLeft{\textcolor{red}{COPYRIGHTSPACE}}}

\begin{document}

\title{design and development of the ecr ion source control system\thanks{Work supported by ...}}

\author{ Hyungjoo Son, Sangil Lee, Chang Wook Son, Hyojae Jang, IBS, Daejeon, S.Korea\\}

\maketitle

%
\begin{abstract}
The Rare Isotope Science Project at the Institute for Basic Science constructs a heavy ion accelerator (RAON) facility in South Korea. The stable ion beam for the RAON accelerator could be generated by ECR ion source system. Therefore, it is necessary to build an ECR ion source control system that could be integrated into an accelerator control system easily. The vacuum control system is divided several parts because of one vacuum chamber among three different voltage stages (ground, 50 kV, and 80 kV).
In this report, we will present the preliminary design and implementation of vacuum control system for the ECR ion source. We plan to use a Programmable Logic Controller (PLC) in order to control the vacuum system through interlock logic program. The PLC system has two major components: a digital I/O module that provides power to each component and standard RS-232 modules to connect the gauge and pump controllers. In addition, we will discuss its extension plan to integrate the vacuum control system into the RAON accelerator control system based on the EPICS framework.
  
\end{abstract}


\section{system configuration}
The driver linac injector of the RAON consists of a 28-GHz superconducting Electron Cyclotron Radiation (ECR) ion source, the LEBT (low energy beam transport), the 500-keV/u RFQ (radio-frequency quadrupole) and the MEBT (medium energy beam transport). For the ECR ion source, superconducting magnets and dual high power RF sources of 28 GHz and 18 GHz are used to improve its performance [1]. The high voltage ion sources could get from two different high voltage platforms (50kV and 80kV).
The Vacuum control system for the ECR ion source is consisted of Allen-Bradley PLC (AB PLC) modules. The AB PLC chassis consists of four chassis and are installed each of the electrical potentials racks. Each vacuum control devices are connected with AB PLC modules to control turbo pumps and to read pressure of the vacuum chamber. Vacuum gauge controller (XGS-600) is used to read pressure and to communicate with AB PLC through serial cable using RS232 protocol. Similarly, OSAKA turbo pump controller and LAYBOLD turbo pump controller are used to operate turbo pumps with AB PLC through serial cable.
In order to construct the network system for connection among multi-voltage stages, we used remote IO modules 1756-AN2TR and 1734-AENTR of AB PLC. 175 6-AN2TR and 1734-AENTR modules are used to connect each of two racks on ground state through LAN cable by MOXA switch. And 1783-ETAP2F modules has used to connect among one rack of ground state and two racks installed on high voltage stages (50 kV and 80 kV) directly through optical fibers because communication failure occurred when LAN cable is used. The basic configuration of the control system is indicated by the network diagram shown in Fig. 1. Dashed lines are optical fibers and solid lines are LAN cables. Each chassis are installed at each platform as below figure 4.
Internet Protocol (IP) address is assigned to two areas 192.168.1.* (area A) and 100.100.100.* (area B) according to voltage platforms level to reduce the risks from high voltage difference. The area ‘A’ is connected to total network of the test facility that included the ECR ion source facility. The area ‘B’ is local network that connects between remote IO modules of the AB PLC only. Because the IP address is not enough when configure the total network system of the test facility.
The control system performs the interlocks for the vacuum system of the ECR ion source. And this system will be integrated with the Experimental Physics and Industrial Control System (EPICS) to operate the system record the parameter values by EPICS Input Output Controller (IOC) using “process variables” in real-time.

\begin{figure}[!htb]
	\centering
	\includegraphics*[width=65mm]{MOPGF119f1}
	\caption{Diagram of network system for ECR ion source control system. 1783-ETAP2F modules for optical communication are used to connect between the high voltage platform and the control module that installed on ground platform.}
\end{figure}


\begin{figure}[!htb]
	\centering
	\includegraphics*[width=65mm]{MOPGF119f2}
	\caption{Preliminary test setup for confirming the network and I/O wiring. Left dashed box in figure is area ‘A’, Right solid box is area ‘B’.}
\end{figure}

\section{Vacuum control system}
Vacuum control system of the ECR ion source consists of several turbo molecular pumps and controllers. They are installed at each voltage platforms. TC 353 turbo pump controller is installed at the ground platform and TC 2403 is installed at the 50kV platform. Both are made by OSAKA vacuum. TD 20 manufactured by LAYBOLD vacuum company is installed at 80kV platform. Each controller communicates with serial communication module (1734-232ASC) of AB PLC through serial cable.   
An AB PLC CPU 1756-L71 is used to control entire system of the ECR ion source and is installed at ground platform control rack of area ‘A’ (Fig 2). As can be seen from the Fig 2, four slots of the control rack are emptied to install MODBUS communication module to integrate on the EPICS framework after local control test. We performed communication test among the AB PLC and the OSAKA turbo pump controller (TC353) as non-handshake method, the vacuum gauge controller (XGS600). TC353 comes with local and remote capabilities but we can’t select these modes at the same time during the serial communication mode. TC353 and XGS600 are coupled with each other to control the vacuum system. We used Logix5000 software to send the command message and to receive the return message with each controller through RS-232 protocol. We completed communication test successfully to set each value of the parameters and to operate vacuum device.  
The electric wiring with vacuum components for IO control is proceeding after communication test. Presently, PLC modules are installed at each rack as shown in Table 1.
The ladder logic programming for sequence control of the PLC is developed with Logix5000 software using Window based PC. The RSLinx software is used for setting network environment of the AB PLC. The ladder logic program will be designed independently to protect vacuum devices of the ECR ion source. The interlock program designed by PLC could perform protection for the vacuum system even when upper control system is shut down as system fail.

\begin{table}[hbt]
	\centering
	\caption{PLC modules}
\begin{tabular}{lclclclcl}
	\toprule
	\textbf{Margin} & \textbf{Module}  & \textbf{Q'ty}   & \textbf{Function} \\
	\midrule
	\text{Control rack} & \text{1756-PA72} & \text{1ea} & \text{Power supply}\\
	\text{            } & \text{1756-ENTR} & \text{1ea} & \text{Networking}\\
    \text{            } & \text{1756-EN2TR}& \text{1ea} & \text{Networking}\\
    \text{            } & \text{1783-ETAP2F} & \text{1ea} & \text{CPU}\\
	\midrule
	\text{GND rack    } & \text{1734-AENTR} & \text{1ea} & \text{Networking}\\
	\text{            } & \text{1734-232ASC} & \text{2ea} & \text{Communication}\\
	\text{            } & \text{1734-IB4}& \text{1ea} & \text{Digital Input}\\
	\text{            } & \text{1734-OB8} & \text{1ea} & \  text{Digital Output}\\
	\text{            } & \text{1734-IE2C} & \text{1ea} & \text{Analog Input}\\	
	\midrule
	\text{50kV        } & \text{1783-ETAP2F} & \text{1ea} & \text{Networking}\\
	\text{            } & \text{1734-AENTR} & \text{1ea} & \text{Networking}\\
	\text{            } & \text{1734-232ASC}& \text{2ea} & \text{Communication}\\
	\text{            } & \text{1734-IB4} & \text{1ea} & \text{Digital Input}\\
	\text{            } & \text{1734-OB8} & \text{1ea} & \text{Digital Output}\\
	\text{            } & \text{1734-IE2C} & \text{1ea} & \text{Digital Input}\\
	\midrule
	\text{80kV        } & \text{1783-ETAP2F} & \text{1ea} & \text{Networking}\\
	\text{            } & \text{1734-AENTR} & \text{1ea} & \text{Networking}\\
	\text{            } & \text{1734-232ASC}& \text{2ea} & \text{Communication}\\ 
	\text{            } & \text{1734-IB4} & \text{1ea} & \text{Digital Input}\\
	\text{            } & \text{1734-OB8} & \text{1ea} & \text{Digital Output}\\
	\text{            } & \text{1734-IE2C} & \text{1ea} &  \text{Digital Input}\\	
	\bottomrule
	
\end{tabular}  
\label{l2ea4-t1}
\end{table}

We configured demo vacuum control system like the vacuum system of the ECR ion source to test serial communication for turbo pump controller and vacuum gauge controller as Fig 3. Because ECR experiment group are performing test for developing the ECR ion source manually. 
We performed communication test among AB PLC and the OSAKA turbo pump controller (TC353) as non-handshake method, the vacuum gauge controller (XGS600). TC353 comes with local and remote capabilities but we can’t select these modes at the same time during the serial communica tion mode. TC353 and XGS600 are coupled with each other to control the vacuum system. We used Logix5000 software to send the command message and to receive the return message with each controller through RS-232 protocol. We completed communication test successfully to set each value of the parameters and to operate vacuum device.  

\begin{figure}[!htb]
   \centering
   \includegraphics*[width=65mm]{MOPGF119f3}
   \caption{Demo vacuum control system with turbo pump and several vacuum gauges.}
   \label{l2ea4-f1}
\end{figure}

\begin{figure}[!htb]
	\centering
	\includegraphics*[width=65mm]{MOPGF119f4}
	\caption{Installed chassis on each platform to configure the vacuum interlock system of the ECR ion source.}
	\label{l2ea4-f1}
\end{figure}



\section{Summary}
We completed control test to operate vacuum pump and gauges through demo vacuum control system for the ECR ion source vacuum control. We will modify the vacuum control system of the ECR ion source to operate the system automatically through hard wiring between devices and PLC modules that are operated currently manually. %
% this setting when the default (\flushend)
% => "balance two column" shows bad results
%
\iftrue   % balancing with bad results
\newpage
\raggedend
\fi
The system will be integrated with EPICS framework thr ough Modbus TCP/IP module or Ether-IP module of the AB PLC. We are developing the EPICS IOC to control the vacuum system in real-time using EPICS drivers. 
The User Interface (UI) for monitoring and operating the system will be developed by the Control System Studio (CSS) software to provide easy control environment for users.
The vacuum control system of the ECR ion source is finally designed by the ladder logic program to perform the interlock checks continuously without data from the EPICS IOC so that the PLC can perform its protection functions even when the IOC is  shut down [2].

\section{acknowledgment}
This work is supported by the Rare Isotope Science Project funded by Ministry of Science, ICT and Future Planning(\SEC{MISP}) and National Research Foundation(\SEC{NRF}) of Korea(Project No. 2011-0032011).

%
% this setting when the default (\flushend)
% => "balance two column" shows bad results 
%
\iftrue   % balancing with bad results
\raggedend
\fi

%\begin{thebibliography}{9}   % Use for  1-9  references
\begin{thebibliography}{99} % Use for 10-99 references
 
%\bibitem{accelconf-ref}
%	C. Petit-Jean-Genaz and J. Poole,
%	``JACoW, A service to the Accelerator Community,''
%	EPAC'04, Lucerne, July 2004, THZCH03,  p.~249,
%	\url{http://www.JACoW.org/e04/papers/THZCH03.PDF}

\bibitem{ref_1}
	
	D. JEON et al., “Design of the RAON Accelerator System”, Journal of the Korean Physical Society, Vol. 65, No. 7, October 2014,  pp. 1010 $\sim$1019.

\bibitem{ref_2}
    M. E. Bannister†, F.W. Meyer, and J. Sinclair, ORNL, Oak Ridge, TN 37831-6372, USA



\end{thebibliography}



\end{document}
